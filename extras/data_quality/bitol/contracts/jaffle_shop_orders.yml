dataContractSpecification: 0.9.2
id: jaffle_shop_orders
info:
  title: Jaffle Shop Orders
  version: 1.0.0
  description: |
    Customer orders from the jaffle_shop ERP system.

    This table tracks order transactions with customer relationships.
    Baseline state: 500 orders (IDs 1-500)
    Day 1 delta: +60 orders (IDs 501-560)
    Day 2 delta: +55 orders (IDs 561-615)
    Day 3 delta: +65 orders (IDs 616-680)
  owner: Demo Team
  contact:
    name: dbt-origin-simulator-ops
    url: https://github.com/feriksen-personal/dbt-origin-simulator-ops

servers:
  duckdb:
    type: duckdb
    location: data/ingestion_simulator.duckdb
    schema: jaffle_shop
  databricks:
    type: databricks
    host: ${DATABRICKS_SERVER_HOSTNAME}
    catalog: ${DATABRICKS_CATALOG}
    schema: erp
    http_path: ${DATABRICKS_HTTP_PATH}

models:
  orders:
    description: Customer orders table
    type: table
    fields:
      order_id:
        type: integer
        required: true
        primary: true
        description: Unique order identifier
        example: "1"

      customer_id:
        type: integer
        required: false
        description: Foreign key to customers table
        example: "1"
        references: jaffle_shop.customers.customer_id

      order_date:
        type: date
        required: false
        description: Order placement date
        example: "2024-01-15"

      status:
        type: varchar
        required: false
        description: Order status
        example: "pending"
        maxLength: 20
        enum:
          - pending
          - processing
          - shipped
          - delivered
          - cancelled

      created_at:
        type: timestamp
        required: true
        description: Record creation timestamp
        example: "2024-01-01T00:00:00Z"

      updated_at:
        type: timestamp
        required: true
        description: Record last update timestamp
        example: "2024-01-01T00:00:00Z"

      deleted_at:
        type: timestamp
        required: false
        description: Soft delete timestamp (NULL = active, non-NULL = cancelled)
        example: null

quality:
  type: SodaCL
  specification: |
    checks for orders:
      # Row count validation (append-only, never decreases)
      - row_count >= 500
      - missing_count(order_id) = 0
      - duplicate_count(order_id) = 0
      # Referential integrity
      - values in (customer_id) must exist in jaffle_shop.customers (customer_id)
      # Data quality
      - invalid_count(status) = 0:
          valid values: ['pending', 'processing', 'shipped', 'delivered', 'cancelled']

tags:
  - demo
  - deterministic
  - erp
  - transactional
