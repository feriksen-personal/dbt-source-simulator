{#
  Internal macros that return SQL content for DuckDB adapter.
  Each macro returns the SQL as a string to be executed via run_query().

  This file is auto-generated from SQL files in data/duckdb/.
  To regenerate, run: python /tmp/convert_sql_to_macros.py
#}

{% macro _get_duckdb_baseline_shop_schema() %}
-- Create schema first
CREATE SCHEMA IF NOT EXISTS jaffle_shop;

-- jaffle_shop database schema
-- E-commerce/ERP system tables

-- Customers table
CREATE TABLE IF NOT EXISTS jaffle_shop.customers (
    customer_id INTEGER PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    email VARCHAR(100),
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP  -- NULL = active, non-NULL = soft deleted
);

-- Products table
CREATE TABLE IF NOT EXISTS jaffle_shop.products (
    product_id INTEGER PRIMARY KEY,
    name VARCHAR(100),
    category VARCHAR(50),
    price DECIMAL(10,2),
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP  -- NULL = active, non-NULL = discontinued
);

-- Orders table
CREATE TABLE IF NOT EXISTS jaffle_shop.orders (
    order_id INTEGER PRIMARY KEY,
    customer_id INTEGER,
    order_date DATE,
    status VARCHAR(20),
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP,  -- NULL = active, non-NULL = cancelled/deleted
    FOREIGN KEY (customer_id) REFERENCES jaffle_shop.customers(customer_id)
);

-- Order items table
CREATE TABLE IF NOT EXISTS jaffle_shop.order_items (
    order_item_id INTEGER PRIMARY KEY,
    order_id INTEGER,
    product_id INTEGER,
    quantity INTEGER,
    unit_price DECIMAL(10,2),
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP,  -- Rarely used (line items typically immutable)
    FOREIGN KEY (order_id) REFERENCES jaffle_shop.orders(order_id),
    FOREIGN KEY (product_id) REFERENCES jaffle_shop.products(product_id)
);
{% endmacro %}

{% macro _get_duckdb_baseline_shop_seed() %}
-- jaffle_shop baseline seed data
-- Matches data from infrastructure repo: scripts/02_load_baseline_data.sh

-- Seed customers (spread over 5 days to show customer acquisition pattern)
INSERT INTO jaffle_shop.customers (customer_id, first_name, last_name, email, created_at, updated_at, deleted_at) VALUES
(1, 'Michael', 'Scott', 'michael.scott@dundermifflin.com', CURRENT_TIMESTAMP - INTERVAL '5 days', CURRENT_TIMESTAMP - INTERVAL '5 days', NULL),
(2, 'Dwight', 'Schrute', 'dwight.schrute@dundermifflin.com', CURRENT_TIMESTAMP - INTERVAL '4 days', CURRENT_TIMESTAMP - INTERVAL '4 days', NULL),
(3, 'Jim', 'Halpert', 'jim.halpert@dundermifflin.com', CURRENT_TIMESTAMP - INTERVAL '3 days', CURRENT_TIMESTAMP - INTERVAL '3 days', NULL),
(4, 'Pam', 'Beesly', 'pam.beesly@dundermifflin.com', CURRENT_TIMESTAMP - INTERVAL '2 days', CURRENT_TIMESTAMP - INTERVAL '2 days', NULL),
(5, 'Ryan', 'Howard', 'ryan.howard@dundermifflin.com', CURRENT_TIMESTAMP - INTERVAL '1 day', CURRENT_TIMESTAMP - INTERVAL '1 day', NULL);

-- Seed products (created 30 days ago - established catalog)
INSERT INTO jaffle_shop.products (product_id, name, category, price, created_at, updated_at, deleted_at) VALUES
(1, 'Laptop', 'Electronics', 999.99, CURRENT_TIMESTAMP - INTERVAL '30 days', CURRENT_TIMESTAMP - INTERVAL '30 days', NULL),
(2, 'Mouse', 'Electronics', 29.99, CURRENT_TIMESTAMP - INTERVAL '30 days', CURRENT_TIMESTAMP - INTERVAL '30 days', NULL),
(3, 'Keyboard', 'Electronics', 79.99, CURRENT_TIMESTAMP - INTERVAL '30 days', CURRENT_TIMESTAMP - INTERVAL '30 days', NULL),
(4, 'Monitor', 'Electronics', 299.99, CURRENT_TIMESTAMP - INTERVAL '30 days', CURRENT_TIMESTAMP - INTERVAL '30 days', NULL),
(5, 'Desk Chair', 'Furniture', 199.99, CURRENT_TIMESTAMP - INTERVAL '15 days', CURRENT_TIMESTAMP - INTERVAL '15 days', NULL);

-- Seed orders (recent activity over last 5 days)
INSERT INTO jaffle_shop.orders (order_id, customer_id, order_date, status, created_at, updated_at, deleted_at) VALUES
-- Order 1: Created 5 days ago, completed next day
(1, 1, CURRENT_DATE - 5, 'completed', CURRENT_TIMESTAMP - INTERVAL '5 days', CURRENT_TIMESTAMP - INTERVAL '4 days', NULL),
-- Order 2: Created 4 days ago, completed next day
(2, 2, CURRENT_DATE - 4, 'completed', CURRENT_TIMESTAMP - INTERVAL '4 days', CURRENT_TIMESTAMP - INTERVAL '3 days', NULL),
-- Order 3: Created 3 days ago, still pending
(3, 3, CURRENT_DATE - 3, 'pending', CURRENT_TIMESTAMP - INTERVAL '3 days', CURRENT_TIMESTAMP - INTERVAL '3 days', NULL),
-- Order 4: Created 2 days ago, completed next day
(4, 4, CURRENT_DATE - 2, 'completed', CURRENT_TIMESTAMP - INTERVAL '2 days', CURRENT_TIMESTAMP - INTERVAL '1 day', NULL),
-- Order 5: Created 1 day ago, cancelled same day
(5, 5, CURRENT_DATE - 1, 'cancelled', CURRENT_TIMESTAMP - INTERVAL '1 day', CURRENT_TIMESTAMP - INTERVAL '1 day', NULL);

-- Seed order items (created with their orders, immutable)
INSERT INTO jaffle_shop.order_items (order_item_id, order_id, product_id, quantity, unit_price, created_at, updated_at, deleted_at) VALUES
(1, 1, 1, 1, 999.99, CURRENT_TIMESTAMP - INTERVAL '5 days', CURRENT_TIMESTAMP - INTERVAL '5 days', NULL),
(2, 1, 2, 2, 29.99, CURRENT_TIMESTAMP - INTERVAL '5 days', CURRENT_TIMESTAMP - INTERVAL '5 days', NULL),
(3, 2, 3, 1, 79.99, CURRENT_TIMESTAMP - INTERVAL '4 days', CURRENT_TIMESTAMP - INTERVAL '4 days', NULL),
(4, 3, 4, 1, 299.99, CURRENT_TIMESTAMP - INTERVAL '3 days', CURRENT_TIMESTAMP - INTERVAL '3 days', NULL),
(5, 4, 5, 1, 199.99, CURRENT_TIMESTAMP - INTERVAL '2 days', CURRENT_TIMESTAMP - INTERVAL '2 days', NULL);
{% endmacro %}

{% macro _get_duckdb_baseline_crm_schema() %}
-- Create schema first
CREATE SCHEMA IF NOT EXISTS jaffle_crm;

-- jaffle_crm database schema
-- Marketing/CRM system tables

-- Campaigns table
CREATE TABLE IF NOT EXISTS jaffle_crm.campaigns (
    campaign_id INTEGER PRIMARY KEY,
    campaign_name VARCHAR(100),
    start_date DATE,
    end_date DATE,
    budget DECIMAL(10,2),
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP  -- NULL = active, non-NULL = archived
);

-- Email activity table (append-only event stream)
CREATE TABLE IF NOT EXISTS jaffle_crm.email_activity (
    activity_id INTEGER PRIMARY KEY,
    customer_id INTEGER,
    campaign_id INTEGER,
    sent_date TIMESTAMP,
    opened BOOLEAN,
    clicked BOOLEAN,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,  -- When event was recorded
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,  -- Rarely changes (append-only)
    deleted_at TIMESTAMP,  -- Rarely used (events are immutable)
    FOREIGN KEY (campaign_id) REFERENCES jaffle_crm.campaigns(campaign_id)
);

-- Web sessions table (append-only event stream)
CREATE TABLE IF NOT EXISTS jaffle_crm.web_sessions (
    session_id INTEGER PRIMARY KEY,
    customer_id INTEGER,
    session_start TIMESTAMP,
    session_end TIMESTAMP,
    page_views INTEGER,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,  -- When session was recorded
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,  -- Could update if session extends
    deleted_at TIMESTAMP  -- Rarely used
);
{% endmacro %}

{% macro _get_duckdb_baseline_crm_seed() %}
-- jaffle_crm baseline seed data
-- Matches data from infrastructure repo: scripts/02_load_baseline_data.sh

-- Seed campaigns (created within last 30 days, with logical date ranges)
INSERT INTO jaffle_crm.campaigns (campaign_id, campaign_name, start_date, end_date, budget, created_at, updated_at, deleted_at) VALUES
-- Campaign 1: Created 30 days ago, ran for 10 days (now ended)
(1, 'New Year Sale', CURRENT_DATE - 28, CURRENT_DATE - 18, 5000.00, CURRENT_DATE - 30, CURRENT_DATE - 30, NULL),
-- Campaign 2: Created 20 days ago, started 18 days ago, running now (ends in 2 days)
(2, 'Flash Deals', CURRENT_DATE - 18, CURRENT_DATE + 2, 7500.00, CURRENT_DATE - 20, CURRENT_DATE - 20, NULL),
-- Campaign 3: Created 10 days ago, started 8 days ago, runs for 2 more weeks
(3, 'Customer Appreciation', CURRENT_DATE - 8, CURRENT_DATE + 14, 6000.00, CURRENT_DATE - 10, CURRENT_DATE - 10, NULL);

-- Seed email activity (events from last 5 days, tied to active campaigns)
INSERT INTO jaffle_crm.email_activity (activity_id, customer_id, campaign_id, sent_date, opened, clicked, created_at, updated_at, deleted_at) VALUES
(1, 1, 2, CURRENT_DATE - 5, true, true, CURRENT_DATE - 5, CURRENT_DATE - 5, NULL),
(2, 2, 2, CURRENT_DATE - 5, true, false, CURRENT_DATE - 5, CURRENT_DATE - 5, NULL),
(3, 3, 2, CURRENT_DATE - 5, false, false, CURRENT_DATE - 5, CURRENT_DATE - 5, NULL),
(4, 4, 3, CURRENT_DATE - 2, true, true, CURRENT_DATE - 2, CURRENT_DATE - 2, NULL),
(5, 5, 3, CURRENT_DATE - 2, true, true, CURRENT_DATE - 2, CURRENT_DATE - 2, NULL);

-- Seed web sessions (activity from last 5 days)
INSERT INTO jaffle_crm.web_sessions (session_id, customer_id, session_start, session_end, page_views, created_at, updated_at, deleted_at) VALUES
(1, 1, CURRENT_DATE - 5, CURRENT_DATE - 5, 12, CURRENT_DATE - 5, CURRENT_DATE - 5, NULL),
(2, 2, CURRENT_DATE - 4, CURRENT_DATE - 4, 5, CURRENT_DATE - 4, CURRENT_DATE - 4, NULL),
(3, 3, CURRENT_DATE - 3, CURRENT_DATE - 3, 20, CURRENT_DATE - 3, CURRENT_DATE - 3, NULL),
(4, 4, CURRENT_DATE - 2, CURRENT_DATE - 2, 8, CURRENT_DATE - 2, CURRENT_DATE - 2, NULL),
(5, 5, CURRENT_DATE - 1, CURRENT_DATE - 1, 3, CURRENT_DATE - 1, CURRENT_DATE - 1, NULL);
{% endmacro %}

{% macro _get_duckdb_utilities_truncate_shop() %}
-- Truncate all jaffle_shop tables
-- Order matters: delete child tables before parent tables to avoid FK constraint errors

-- Delete order items first (has FKs to orders and products)
DELETE FROM jaffle_shop.order_items;

-- Delete orders next (has FK to customers)
DELETE FROM jaffle_shop.orders;

-- Delete products (no dependencies on it anymore)
DELETE FROM jaffle_shop.products;

-- Delete customers last (no dependencies on it anymore)
DELETE FROM jaffle_shop.customers;
{% endmacro %}

{% macro _get_duckdb_utilities_truncate_crm() %}
-- Truncate all jaffle_crm tables
-- Order matters: delete child tables before parent tables to avoid FK constraint errors

-- Delete email activity first (has FK to campaigns)
DELETE FROM jaffle_crm.email_activity;

-- Delete web sessions (no FK dependencies)
DELETE FROM jaffle_crm.web_sessions;

-- Delete campaigns last (was referenced by email_activity)
DELETE FROM jaffle_crm.campaigns;
{% endmacro %}

{% macro _get_duckdb_deltas_day_01_shop() %}
-- jaffle_shop Day 01 delta changes
-- Simulates business activity on Day 01 after baseline

-- Add 25 new customers
INSERT INTO jaffle_shop.customers (customer_id, first_name, last_name, email, created_at, updated_at, deleted_at) VALUES
(101, 'Brian', 'Kapoor', 'brian.kapoor101@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(102, 'Phyllis', 'Smith', 'phyllis.smith102@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(103, 'Helene', 'Cordray', 'helene.cordray103@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(104, 'Dwight', 'Kapoor', 'dwight.kapoor104@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(105, 'Brian', 'California', 'brian.california105@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(106, 'Helene', 'Filippelli', 'helene.filippelli106@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(107, 'Meredith', 'Smith', 'meredith.smith107@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(108, 'Stanley', 'Martin', 'stanley.martin108@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(109, 'Roy', 'Bratton', 'roy.bratton109@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(110, 'Clark', 'Lipton', 'clark.lipton110@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(111, 'Toby', 'Lewis', 'toby.lewis111@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(112, 'Karen', 'Withem', 'karen.withem112@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(113, 'Dwight', 'Anderson', 'dwight.anderson113@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(114, 'Meredith', 'Simms', 'meredith.simms114@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(115, 'Darryl', 'Kapoor', 'darryl.kapoor115@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(116, 'Donna', 'Lipton', 'donna.lipton116@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(117, 'Meredith', 'Hannon', 'meredith.hannon117@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(118, 'Helene', 'Hannon', 'helene.hannon118@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(119, 'Darryl', 'Hannon', 'darryl.hannon119@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(120, 'Charles', 'Palmer', 'charles.palmer120@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(121, 'Angela', 'Flenderson', 'angela.flenderson121@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(122, 'Charles', 'Flenderson', 'charles.flenderson122@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(123, 'Pam', 'Anderson', 'pam.anderson123@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(124, 'Roy', 'Packer', 'roy.packer124@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(125, 'Meredith', 'Bratton', 'meredith.bratton125@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add 60 new orders
INSERT INTO jaffle_shop.orders (order_id, customer_id, order_date, status, created_at, updated_at, deleted_at) VALUES
(251, 101, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(252, 102, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(253, 103, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(254, 104, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(255, 105, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(256, 106, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(257, 107, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(258, 108, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(259, 109, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(260, 110, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(261, 111, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(262, 112, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(263, 113, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(264, 114, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(265, 115, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(266, 116, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(267, 117, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(268, 118, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(269, 119, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(270, 120, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(271, 121, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(272, 122, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(273, 123, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(274, 124, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(275, 125, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(276, 92, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(277, 23, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(278, 9, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(279, 101, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(280, 101, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(281, 60, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(282, 5, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(283, 80, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(284, 93, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(285, 83, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(286, 30, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(287, 55, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(288, 32, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(289, 84, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(290, 124, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(291, 31, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(292, 87, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(293, 89, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(294, 68, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(295, 96, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(296, 68, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(297, 13, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(298, 34, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(299, 79, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(300, 58, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(301, 54, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(302, 89, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(303, 66, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(304, 47, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(305, 120, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(306, 50, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(307, 31, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(308, 25, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(309, 123, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(310, 75, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add order items for new orders
INSERT INTO jaffle_shop.order_items (order_item_id, order_id, product_id, quantity, unit_price, created_at, updated_at, deleted_at) VALUES
(351, 251, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(352, 252, 6, 2, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(353, 252, 8, 3, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(354, 253, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(355, 253, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(356, 253, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(357, 254, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(358, 254, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(359, 255, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(360, 255, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(361, 256, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(362, 256, 7, 2, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(363, 257, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(364, 258, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(365, 258, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(366, 259, 2, 2, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(367, 259, 7, 2, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(368, 259, 1, 2, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(369, 260, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(370, 261, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(371, 261, 9, 3, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(372, 262, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(373, 263, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(374, 264, 2, 1, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(375, 264, 1, 2, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(376, 264, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(377, 265, 8, 3, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(378, 266, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(379, 266, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(380, 266, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(381, 267, 9, 3, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(382, 267, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(383, 267, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(384, 268, 1, 1, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(385, 268, 4, 2, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(386, 269, 1, 1, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(387, 270, 1, 2, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(388, 271, 10, 2, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(389, 272, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(390, 273, 2, 3, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(391, 274, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(392, 275, 9, 3, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(393, 276, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(394, 276, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(395, 277, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(396, 278, 6, 3, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(397, 279, 1, 1, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(398, 279, 10, 3, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(399, 280, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(400, 281, 1, 1, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(401, 282, 1, 1, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(402, 283, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(403, 283, 2, 1, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(404, 284, 3, 2, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(405, 284, 6, 3, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(406, 285, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(407, 285, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(408, 286, 4, 3, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(409, 286, 1, 1, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(410, 286, 2, 1, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(411, 287, 2, 3, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(412, 288, 5, 2, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(413, 288, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(414, 289, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(415, 290, 7, 2, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(416, 290, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(417, 291, 4, 2, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(418, 291, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(419, 292, 3, 2, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(420, 292, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(421, 293, 2, 3, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(422, 294, 2, 1, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(423, 294, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(424, 294, 2, 1, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(425, 295, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(426, 296, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(427, 297, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(428, 297, 2, 1, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(429, 298, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(430, 299, 2, 2, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(431, 299, 2, 1, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(432, 299, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(433, 300, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(434, 300, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(435, 301, 2, 1, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(436, 301, 2, 1, 29.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(437, 302, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(438, 303, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(439, 303, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(440, 304, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(441, 304, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(442, 304, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(443, 305, 7, 3, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(444, 306, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(445, 307, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(446, 308, 10, 2, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(447, 308, 3, 3, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(448, 308, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(449, 309, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(450, 309, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(451, 309, 9, 2, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(452, 310, 3, 3, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(453, 310, 1, 1, 999.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add payments for completed orders
INSERT INTO jaffle_shop.payments (payment_id, order_id, payment_method, amount, created_at, updated_at, deleted_at) VALUES
(221, 252, 'credit_card', 360.19, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(222, 252, 'credit_card', 974.54, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(223, 253, 'credit_card', 1457.35, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(224, 253, 'bank_transfer', 755.77, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(225, 254, 'credit_card', 1030.57, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(226, 255, 'coupon', 306.46, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(227, 256, 'coupon', 235.05, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(228, 257, 'credit_card', 59.86, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(229, 258, 'credit_card', 324.58, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(230, 259, 'coupon', 1305.64, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(231, 259, 'coupon', 1008.59, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(232, 260, 'credit_card', 1262.17, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(233, 261, 'credit_card', 258.79, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(234, 262, 'credit_card', 625.97, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(235, 263, 'coupon', 348.14, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(236, 264, 'bank_transfer', 958.84, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(237, 265, 'credit_card', 480.57, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(238, 270, 'credit_card', 1408.06, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(239, 270, 'bank_transfer', 671.72, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(240, 272, 'credit_card', 399.69, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(241, 274, 'bank_transfer', 1044.77, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(242, 274, 'coupon', 1377.38, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(243, 275, 'coupon', 1051.67, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(244, 278, 'credit_card', 125.29, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(245, 280, 'gift_card', 199.12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(246, 281, 'credit_card', 1393.31, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(247, 282, 'bank_transfer', 951.09, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(248, 283, 'bank_transfer', 1257.13, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(249, 284, 'credit_card', 837.23, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(250, 285, 'credit_card', 397.96, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(251, 289, 'credit_card', 620.1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(252, 290, 'credit_card', 198.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(253, 291, 'bank_transfer', 849.29, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(254, 292, 'credit_card', 1330.3, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(255, 292, 'credit_card', 416.13, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(256, 294, 'credit_card', 519.89, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(257, 295, 'coupon', 1117.9, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(258, 296, 'bank_transfer', 673.83, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(259, 297, 'credit_card', 157.38, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(260, 298, 'credit_card', 257.33, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(261, 300, 'credit_card', 981.92, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(262, 300, 'coupon', 1176.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(263, 301, 'credit_card', 59.42, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(264, 302, 'bank_transfer', 951.24, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(265, 303, 'credit_card', 1337.6, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(266, 303, 'credit_card', 472.97, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(267, 304, 'coupon', 360.46, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(268, 306, 'credit_card', 996.12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(269, 306, 'credit_card', 398.89, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(270, 307, 'bank_transfer', 1354.19, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(271, 309, 'bank_transfer', 297.77, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(272, 310, 'coupon', 1266.84, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Complete 15 pending orders from previous days
UPDATE jaffle_shop.orders
SET status = 'completed',
    updated_at = CURRENT_TIMESTAMP
WHERE order_id IN (192, 230, 219, 224, 185, 234, 202, 244, 177, 159, 243, 198, 169, 163, 212);
{% endmacro %}

{% macro _get_duckdb_deltas_day_01_crm() %}
-- jaffle_crm Day 01 delta changes
-- Simulates marketing activity on Day 01

-- Add 40 email activity records
INSERT INTO jaffle_crm.email_activity (activity_id, customer_id, campaign_id, sent_date, opened, clicked, created_at, updated_at, deleted_at) VALUES
(201, 113, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(202, 88, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(203, 46, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(204, 79, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(205, 86, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(206, 51, 3, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(207, 26, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(208, 91, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(209, 7, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(210, 110, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(211, 75, 3, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(212, 27, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(213, 83, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(214, 61, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(215, 25, 3, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(216, 28, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(217, 11, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(218, 42, 1, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(219, 8, 1, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(220, 117, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(221, 19, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(222, 96, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(223, 4, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(224, 29, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(225, 99, 3, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(226, 65, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(227, 23, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(228, 104, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(229, 28, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(230, 100, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(231, 2, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(232, 114, 2, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(233, 122, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(234, 7, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(235, 9, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(236, 79, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(237, 28, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(238, 66, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(239, 123, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(240, 28, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add 30 web sessions
INSERT INTO jaffle_crm.web_sessions (session_id, customer_id, session_start, session_end, page_views, created_at, updated_at, deleted_at) VALUES
(151, 62, CURRENT_DATE, CURRENT_DATE, 17, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(152, 121, CURRENT_DATE, CURRENT_DATE, 3, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(153, 1, CURRENT_DATE, CURRENT_DATE, 12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(154, 3, CURRENT_DATE, CURRENT_DATE, 10, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(155, 9, CURRENT_DATE, CURRENT_DATE, 6, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(156, 2, CURRENT_DATE, CURRENT_DATE, 16, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(157, 36, CURRENT_DATE, CURRENT_DATE, 27, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(158, 39, CURRENT_DATE, CURRENT_DATE, 13, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(159, 86, CURRENT_DATE, CURRENT_DATE, 3, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(160, 71, CURRENT_DATE, CURRENT_DATE, 28, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(161, 19, CURRENT_DATE, CURRENT_DATE, 25, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(162, 33, CURRENT_DATE, CURRENT_DATE, 29, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(163, 14, CURRENT_DATE, CURRENT_DATE, 8, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(164, 15, CURRENT_DATE, CURRENT_DATE, 29, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(165, 24, CURRENT_DATE, CURRENT_DATE, 21, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(166, 64, CURRENT_DATE, CURRENT_DATE, 4, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(167, 22, CURRENT_DATE, CURRENT_DATE, 8, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(168, 29, CURRENT_DATE, CURRENT_DATE, 6, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(169, 40, CURRENT_DATE, CURRENT_DATE, 14, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(170, 123, CURRENT_DATE, CURRENT_DATE, 10, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(171, 92, CURRENT_DATE, CURRENT_DATE, 30, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(172, 47, CURRENT_DATE, CURRENT_DATE, 9, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(173, 85, CURRENT_DATE, CURRENT_DATE, 8, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(174, 56, CURRENT_DATE, CURRENT_DATE, 14, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(175, 40, CURRENT_DATE, CURRENT_DATE, 15, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(176, 79, CURRENT_DATE, CURRENT_DATE, 12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(177, 108, CURRENT_DATE, CURRENT_DATE, 11, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(178, 2, CURRENT_DATE, CURRENT_DATE, 23, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(179, 21, CURRENT_DATE, CURRENT_DATE, 16, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(180, 8, CURRENT_DATE, CURRENT_DATE, 16, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);
{% endmacro %}

{% macro _get_duckdb_deltas_day_02_shop() %}
-- jaffle_shop Day 02 delta changes
-- Simulates business activity on Day 02 after baseline

-- Add 22 new customers
INSERT INTO jaffle_shop.customers (customer_id, first_name, last_name, email, created_at, updated_at, deleted_at) VALUES
(126, 'Cathy', 'Beesly', 'cathy.beesly126@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(127, 'Jim', 'Smith', 'jim.smith127@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(128, 'Meredith', 'Johnson', 'meredith.johnson128@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(129, 'Brian', 'Bennett', 'brian.bennett129@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(130, 'Jo', 'Nickerson', 'jo.nickerson130@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(131, 'Gabe', 'Miller', 'gabe.miller131@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(132, 'Hide', 'Vance', 'hide.vance132@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(133, 'David', 'California', 'david.california133@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(134, 'Karen', 'Bennett', 'karen.bennett134@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(135, 'Tony', 'Miller', 'tony.miller135@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(136, 'Cathy', 'Nickerson', 'cathy.nickerson136@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(137, 'Ryan', 'Hannon', 'ryan.hannon137@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(138, 'Kelly', 'Green', 'kelly.green138@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(139, 'Michael', 'Smith', 'michael.smith139@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(140, 'Kevin', 'Schrute', 'kevin.schrute140@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(141, 'Jo', 'Schrute', 'jo.schrute141@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(142, 'Brian', 'Wallace', 'brian.wallace142@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(143, 'Erin', 'Halpert', 'erin.halpert143@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(144, 'Jordan', 'Halpert', 'jordan.halpert144@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(145, 'Nate', 'Bennett', 'nate.bennett145@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(146, 'Stanley', 'Hudson', 'stanley.hudson146@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(147, 'Senator', 'Vance', 'senator.vance147@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Update product prices (market adjustments)
UPDATE jaffle_shop.products
SET price = 34.99,
    updated_at = CURRENT_TIMESTAMP
WHERE product_id = 2;  -- Mouse price increase

UPDATE jaffle_shop.products
SET price = 1099.99,
    updated_at = CURRENT_TIMESTAMP
WHERE product_id = 1;  -- Laptop price increase

-- Add 55 new orders
INSERT INTO jaffle_shop.orders (order_id, customer_id, order_date, status, created_at, updated_at, deleted_at) VALUES
(311, 126, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(312, 127, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(313, 128, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(314, 129, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(315, 130, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(316, 131, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(317, 132, CURRENT_DATE, 'cancelled', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(318, 133, CURRENT_DATE, 'cancelled', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(319, 134, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(320, 135, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(321, 136, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(322, 137, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(323, 138, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(324, 139, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(325, 140, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(326, 141, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(327, 142, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(328, 143, CURRENT_DATE, 'cancelled', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(329, 144, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(330, 145, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(331, 146, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(332, 147, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(333, 34, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(334, 77, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(335, 49, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(336, 48, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(337, 67, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(338, 104, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(339, 55, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(340, 61, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(341, 55, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(342, 55, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(343, 75, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(344, 147, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(345, 147, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(346, 11, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(347, 59, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(348, 89, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(349, 50, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(350, 37, CURRENT_DATE, 'cancelled', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(351, 139, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(352, 98, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(353, 6, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(354, 130, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(355, 143, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(356, 92, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(357, 80, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(358, 134, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(359, 69, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(360, 63, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(361, 67, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(362, 27, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(363, 21, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(364, 46, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(365, 77, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add order items for new orders
INSERT INTO jaffle_shop.order_items (order_item_id, order_id, product_id, quantity, unit_price, created_at, updated_at, deleted_at) VALUES
(431, 311, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(432, 312, 1, 2, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(433, 312, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(434, 312, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(435, 313, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(436, 313, 8, 3, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(437, 314, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(438, 314, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(439, 315, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(440, 315, 2, 3, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(441, 315, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(442, 316, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(443, 317, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(444, 318, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(445, 318, 6, 3, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(446, 319, 7, 2, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(447, 320, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(448, 321, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(449, 322, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(450, 323, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(451, 323, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(452, 324, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(453, 324, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(454, 325, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(455, 326, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(456, 327, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(457, 328, 9, 2, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(458, 328, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(459, 329, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(460, 330, 6, 3, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(461, 330, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(462, 331, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(463, 332, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(464, 333, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(465, 334, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(466, 335, 1, 3, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(467, 336, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(468, 337, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(469, 337, 6, 3, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(470, 338, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(471, 338, 9, 2, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(472, 339, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(473, 340, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(474, 340, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(475, 341, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(476, 341, 7, 2, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(477, 342, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(478, 343, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(479, 344, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(480, 344, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(481, 345, 6, 3, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(482, 346, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(483, 347, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(484, 348, 5, 2, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(485, 348, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(486, 349, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(487, 350, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(488, 350, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(489, 351, 6, 3, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(490, 351, 3, 3, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(491, 352, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(492, 352, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(493, 353, 7, 3, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(494, 354, 6, 2, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(495, 354, 2, 1, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(496, 355, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(497, 356, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(498, 357, 2, 3, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(499, 357, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(500, 358, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(501, 358, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(502, 359, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(503, 359, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(504, 360, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(505, 360, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(506, 360, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(507, 361, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(508, 362, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(509, 362, 2, 1, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(510, 363, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(511, 364, 1, 3, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(512, 364, 5, 3, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(513, 365, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(514, 365, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add payments for completed orders
INSERT INTO jaffle_shop.payments (payment_id, order_id, payment_method, amount, created_at, updated_at, deleted_at) VALUES
(281, 312, 'coupon', 954.29, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(282, 313, 'gift_card', 622.11, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(283, 313, 'credit_card', 63.69, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(284, 314, 'bank_transfer', 698.19, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(285, 319, 'coupon', 1098.01, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(286, 320, 'bank_transfer', 1478.47, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(287, 320, 'credit_card', 62.97, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(288, 321, 'bank_transfer', 652.88, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(289, 322, 'coupon', 1173.94, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(290, 325, 'credit_card', 1228.59, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(291, 327, 'credit_card', 956.35, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(292, 329, 'credit_card', 1493.88, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(293, 330, 'credit_card', 1414.88, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(294, 332, 'coupon', 790.58, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(295, 333, 'credit_card', 135.24, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(296, 336, 'bank_transfer', 336.12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(297, 338, 'gift_card', 597.2, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(298, 339, 'coupon', 1404.18, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(299, 339, 'credit_card', 586.07, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(300, 340, 'coupon', 1178.76, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(301, 342, 'credit_card', 1253.26, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(302, 343, 'credit_card', 912.86, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(303, 344, 'credit_card', 336.34, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(304, 345, 'credit_card', 1043.05, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(305, 346, 'credit_card', 123.58, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(306, 347, 'credit_card', 149.85, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(307, 348, 'bank_transfer', 362.54, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(308, 351, 'bank_transfer', 900.95, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(309, 351, 'credit_card', 176.26, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(310, 352, 'credit_card', 219.69, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(311, 353, 'credit_card', 323.32, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(312, 355, 'coupon', 917.29, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(313, 356, 'credit_card', 595.86, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(314, 357, 'gift_card', 985.53, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(315, 358, 'credit_card', 1459.51, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(316, 358, 'gift_card', 573.44, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(317, 360, 'credit_card', 1129.73, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(318, 360, 'credit_card', 262.84, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(319, 361, 'credit_card', 819.04, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(320, 362, 'coupon', 831.43, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(321, 363, 'credit_card', 347.05, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(322, 364, 'bank_transfer', 447.85, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(323, 364, 'bank_transfer', 645.62, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(324, 365, 'bank_transfer', 1392.01, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Complete 12 pending orders from previous days
UPDATE jaffle_shop.orders
SET status = 'completed',
    updated_at = CURRENT_TIMESTAMP
WHERE order_id IN (293, 220, 281, 298, 276, 264, 214, 307, 255, 238, 232, 218);
{% endmacro %}

{% macro _get_duckdb_deltas_day_02_crm() %}
-- jaffle_crm Day 02 delta changes
-- Simulates marketing activity on Day 02

-- Add 38 email activity records
INSERT INTO jaffle_crm.email_activity (activity_id, customer_id, campaign_id, sent_date, opened, clicked, created_at, updated_at, deleted_at) VALUES
(241, 108, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(242, 101, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(243, 41, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(244, 120, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(245, 133, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(246, 92, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(247, 121, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(248, 47, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(249, 22, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(250, 37, 2, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(251, 32, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(252, 121, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(253, 56, 2, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(254, 113, 3, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(255, 102, 2, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(256, 35, 1, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(257, 116, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(258, 48, 2, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(259, 1, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(260, 126, 2, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(261, 27, 3, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(262, 146, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(263, 130, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(264, 94, 1, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(265, 92, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(266, 1, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(267, 23, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(268, 54, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(269, 117, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(270, 102, 3, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(271, 124, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(272, 114, 3, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(273, 145, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(274, 145, 3, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(275, 36, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(276, 77, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(277, 89, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(278, 96, 2, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add 28 web sessions
INSERT INTO jaffle_crm.web_sessions (session_id, customer_id, session_start, session_end, page_views, created_at, updated_at, deleted_at) VALUES
(181, 111, CURRENT_DATE, CURRENT_DATE, 14, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(182, 61, CURRENT_DATE, CURRENT_DATE, 28, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(183, 25, CURRENT_DATE, CURRENT_DATE, 7, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(184, 2, CURRENT_DATE, CURRENT_DATE, 16, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(185, 49, CURRENT_DATE, CURRENT_DATE, 11, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(186, 49, CURRENT_DATE, CURRENT_DATE, 3, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(187, 42, CURRENT_DATE, CURRENT_DATE, 22, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(188, 85, CURRENT_DATE, CURRENT_DATE, 14, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(189, 92, CURRENT_DATE, CURRENT_DATE, 12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(190, 12, CURRENT_DATE, CURRENT_DATE, 17, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(191, 74, CURRENT_DATE, CURRENT_DATE, 11, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(192, 134, CURRENT_DATE, CURRENT_DATE, 3, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(193, 126, CURRENT_DATE, CURRENT_DATE, 14, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(194, 100, CURRENT_DATE, CURRENT_DATE, 29, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(195, 52, CURRENT_DATE, CURRENT_DATE, 12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(196, 105, CURRENT_DATE, CURRENT_DATE, 11, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(197, 29, CURRENT_DATE, CURRENT_DATE, 5, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(198, 99, CURRENT_DATE, CURRENT_DATE, 27, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(199, 56, CURRENT_DATE, CURRENT_DATE, 10, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(200, 113, CURRENT_DATE, CURRENT_DATE, 22, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(201, 92, CURRENT_DATE, CURRENT_DATE, 8, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(202, 77, CURRENT_DATE, CURRENT_DATE, 9, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(203, 45, CURRENT_DATE, CURRENT_DATE, 16, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(204, 46, CURRENT_DATE, CURRENT_DATE, 2, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(205, 36, CURRENT_DATE, CURRENT_DATE, 3, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(206, 51, CURRENT_DATE, CURRENT_DATE, 9, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(207, 29, CURRENT_DATE, CURRENT_DATE, 12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(208, 17, CURRENT_DATE, CURRENT_DATE, 25, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);
{% endmacro %}

{% macro _get_duckdb_deltas_day_03_shop() %}
-- jaffle_shop Day 03 delta changes
-- Simulates business activity on Day 03 after baseline

-- Add 28 new customers
INSERT INTO jaffle_shop.customers (customer_id, first_name, last_name, email, created_at, updated_at, deleted_at) VALUES
(148, 'Val', 'Halpert', 'val.halpert148@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(149, 'Ryan', 'Malone', 'ryan.malone149@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(150, 'Gabe', 'Johnson', 'gabe.johnson150@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(151, 'Helene', 'Tanaka', 'helene.tanaka151@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(152, 'Val', 'Vance', 'val.vance152@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(153, 'David', 'Howard', 'david.howard153@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(154, 'Toby', 'Green', 'toby.green154@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(155, 'Brian', 'Miner', 'brian.miner155@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(156, 'David', 'Tanaka', 'david.tanaka156@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(157, 'Jessica', 'Wallace', 'jessica.wallace157@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(158, 'Katy', 'Bratton', 'katy.bratton158@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(159, 'Val', 'Bernard', 'val.bernard159@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(160, 'Oscar', 'Miner', 'oscar.miner160@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(161, 'Jo', 'Flenderson', 'jo.flenderson161@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(162, 'Pam', 'Flenderson', 'pam.flenderson162@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(163, 'Deangelo', 'Smith', 'deangelo.smith163@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(164, 'Kevin', 'Flax', 'kevin.flax164@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(165, 'Dwight', 'Beesly', 'dwight.beesly165@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(166, 'Erin', 'Lipton', 'erin.lipton166@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(167, 'Creed', 'Martin', 'creed.martin167@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(168, 'Donna', 'Martinez', 'donna.martinez168@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(169, 'Jan', 'Bennett', 'jan.bennett169@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(170, 'Robert', 'Withem', 'robert.withem170@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(171, 'Todd', 'Green', 'todd.green171@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(172, 'Robert', 'Kapoor', 'robert.kapoor172@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(173, 'Gabe', 'Wallace', 'gabe.wallace173@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(174, 'Michael', 'Garfield', 'michael.garfield174@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(175, 'Jordan', 'Palmer', 'jordan.palmer175@example.com', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add 65 new orders
INSERT INTO jaffle_shop.orders (order_id, customer_id, order_date, status, created_at, updated_at, deleted_at) VALUES
(366, 148, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(367, 149, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(368, 150, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(369, 151, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(370, 152, CURRENT_DATE, 'cancelled', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(371, 153, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(372, 154, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(373, 155, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(374, 156, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(375, 157, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(376, 158, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(377, 159, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(378, 160, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(379, 161, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(380, 162, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(381, 163, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(382, 164, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(383, 165, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(384, 166, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(385, 167, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(386, 168, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(387, 169, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(388, 170, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(389, 171, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(390, 172, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(391, 173, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(392, 174, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(393, 175, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(394, 89, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(395, 174, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(396, 133, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(397, 99, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(398, 69, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(399, 119, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(400, 92, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(401, 115, CURRENT_DATE, 'cancelled', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(402, 6, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(403, 84, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(404, 129, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(405, 158, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(406, 101, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(407, 30, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(408, 160, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(409, 47, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(410, 89, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(411, 148, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(412, 13, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(413, 164, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(414, 16, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(415, 172, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(416, 52, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(417, 141, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(418, 108, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(419, 141, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(420, 168, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(421, 59, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(422, 154, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(423, 158, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(424, 95, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(425, 66, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(426, 87, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(427, 79, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(428, 110, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(429, 159, CURRENT_DATE, 'completed', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(430, 152, CURRENT_DATE, 'pending', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add order items for new orders
INSERT INTO jaffle_shop.order_items (order_item_id, order_id, product_id, quantity, unit_price, created_at, updated_at, deleted_at) VALUES
(521, 366, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(522, 367, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(523, 368, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(524, 369, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(525, 369, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(526, 369, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(527, 370, 6, 2, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(528, 370, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(529, 370, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(530, 371, 8, 2, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(531, 371, 8, 2, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(532, 372, 8, 2, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(533, 372, 9, 3, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(534, 372, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(535, 373, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(536, 374, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(537, 374, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(538, 375, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(539, 375, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(540, 375, 9, 2, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(541, 376, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(542, 377, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(543, 378, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(544, 379, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(545, 379, 6, 2, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(546, 380, 6, 2, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(547, 381, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(548, 382, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(549, 383, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(550, 384, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(551, 384, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(552, 385, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(553, 385, 7, 2, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(554, 386, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(555, 387, 2, 1, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(556, 387, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(557, 387, 6, 2, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(558, 388, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(559, 388, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(560, 388, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(561, 389, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(562, 389, 5, 2, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(563, 389, 2, 1, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(564, 390, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(565, 390, 4, 2, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(566, 391, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(567, 391, 7, 2, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(568, 392, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(569, 393, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(570, 394, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(571, 394, 8, 3, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(572, 395, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(573, 395, 2, 1, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(574, 396, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(575, 396, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(576, 397, 2, 3, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(577, 397, 9, 2, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(578, 397, 3, 3, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(579, 398, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(580, 398, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(581, 398, 9, 2, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(582, 399, 2, 1, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(583, 399, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(584, 400, 10, 2, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(585, 401, 3, 2, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(586, 401, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(587, 402, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(588, 403, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(589, 404, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(590, 405, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(591, 405, 4, 3, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(592, 406, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(593, 407, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(594, 407, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(595, 408, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(596, 408, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(597, 409, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(598, 409, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(599, 410, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(600, 410, 1, 2, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(601, 411, 8, 1, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(602, 411, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(603, 412, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(604, 413, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(605, 414, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(606, 415, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(607, 415, 10, 3, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(608, 416, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(609, 416, 10, 3, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(610, 417, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(611, 418, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(612, 418, 1, 1, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(613, 418, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(614, 419, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(615, 420, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(616, 421, 7, 1, 89.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(617, 421, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(618, 422, 5, 1, 199.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(619, 423, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(620, 423, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(621, 423, 2, 2, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(622, 424, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(623, 425, 10, 1, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(624, 425, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(625, 426, 3, 2, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(626, 426, 10, 3, 24.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(627, 426, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(628, 427, 9, 1, 399.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(629, 428, 8, 2, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(630, 429, 4, 1, 299.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(631, 429, 3, 1, 79.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(632, 429, 8, 2, 49.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(633, 430, 1, 2, 1099.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(634, 430, 6, 1, 149.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(635, 430, 2, 1, 34.99, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add payments for completed orders
INSERT INTO jaffle_shop.payments (payment_id, order_id, payment_method, amount, created_at, updated_at, deleted_at) VALUES
(341, 366, 'credit_card', 970.14, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(342, 367, 'gift_card', 118.37, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(343, 369, 'gift_card', 1399.95, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(344, 371, 'bank_transfer', 1170.13, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(345, 371, 'credit_card', 452.13, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(346, 372, 'gift_card', 1129.44, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(347, 373, 'bank_transfer', 85.29, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(348, 374, 'credit_card', 569.79, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(349, 376, 'credit_card', 1430.53, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(350, 378, 'credit_card', 263.71, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(351, 378, 'credit_card', 374.35, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(352, 380, 'credit_card', 460.98, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(353, 381, 'bank_transfer', 1272.05, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(354, 382, 'credit_card', 943.62, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(355, 383, 'gift_card', 1348.78, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(356, 383, 'gift_card', 647.06, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(357, 384, 'bank_transfer', 902.06, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(358, 386, 'credit_card', 90.0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(359, 386, 'gift_card', 454.72, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(360, 387, 'gift_card', 834.48, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(361, 388, 'credit_card', 1394.58, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(362, 389, 'credit_card', 575.66, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(363, 391, 'bank_transfer', 1201.87, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(364, 391, 'gift_card', 175.27, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(365, 392, 'gift_card', 616.93, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(366, 393, 'credit_card', 300.98, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(367, 394, 'gift_card', 902.96, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(368, 395, 'coupon', 407.22, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(369, 395, 'credit_card', 1275.17, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(370, 397, 'credit_card', 1105.16, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(371, 398, 'bank_transfer', 1192.79, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(372, 399, 'credit_card', 294.34, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(373, 402, 'credit_card', 245.53, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(374, 403, 'credit_card', 1379.7, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(375, 404, 'credit_card', 422.21, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(376, 406, 'credit_card', 514.22, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(377, 407, 'credit_card', 1262.17, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(378, 408, 'coupon', 1363.93, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(379, 408, 'credit_card', 286.68, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(380, 409, 'credit_card', 1221.08, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(381, 411, 'credit_card', 1325.76, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(382, 412, 'credit_card', 130.24, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(383, 413, 'gift_card', 910.51, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(384, 415, 'credit_card', 947.67, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(385, 416, 'bank_transfer', 859.01, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(386, 417, 'coupon', 1139.12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(387, 418, 'credit_card', 716.09, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(388, 421, 'credit_card', 664.11, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(389, 421, 'gift_card', 832.82, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(390, 422, 'gift_card', 680.84, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(391, 423, 'credit_card', 373.35, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(392, 424, 'coupon', 475.2, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(393, 424, 'credit_card', 984.25, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(394, 426, 'bank_transfer', 787.26, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(395, 426, 'bank_transfer', 590.87, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(396, 428, 'bank_transfer', 1227.23, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(397, 428, 'credit_card', 963.1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(398, 429, 'credit_card', 390.53, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Complete 10 pending orders from previous days
UPDATE jaffle_shop.orders
SET status = 'completed',
    updated_at = CURRENT_TIMESTAMP
WHERE order_id IN (308, 307, 364, 317, 286, 336, 292, 330, 278, 287);

-- Cancel 3 old pending orders
UPDATE jaffle_shop.orders
SET status = 'cancelled',
    updated_at = CURRENT_TIMESTAMP
WHERE order_id IN (310, 318, 293);
{% endmacro %}

{% macro _get_duckdb_deltas_day_03_crm() %}
-- jaffle_crm Day 03 delta changes
-- Simulates marketing activity on Day 03

-- Add 45 email activity records
INSERT INTO jaffle_crm.email_activity (activity_id, customer_id, campaign_id, sent_date, opened, clicked, created_at, updated_at, deleted_at) VALUES
(279, 114, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(280, 75, 3, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(281, 134, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(282, 8, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(283, 132, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(284, 21, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(285, 65, 3, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(286, 64, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(287, 147, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(288, 156, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(289, 81, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(290, 122, 3, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(291, 17, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(292, 164, 1, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(293, 26, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(294, 114, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(295, 30, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(296, 69, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(297, 153, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(298, 156, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(299, 95, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(300, 102, 3, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(301, 108, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(302, 93, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(303, 3, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(304, 19, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(305, 105, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(306, 28, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(307, 150, 1, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(308, 166, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(309, 170, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(310, 29, 2, CURRENT_DATE, true, true, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(311, 139, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(312, 56, 1, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(313, 70, 2, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(314, 136, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(315, 111, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(316, 175, 3, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(317, 131, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(318, 174, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(319, 143, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(320, 99, 2, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(321, 160, 1, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(322, 161, 3, CURRENT_DATE, true, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(323, 8, 3, CURRENT_DATE, false, false, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);

-- Add 32 web sessions
INSERT INTO jaffle_crm.web_sessions (session_id, customer_id, session_start, session_end, page_views, created_at, updated_at, deleted_at) VALUES
(209, 138, CURRENT_DATE, CURRENT_DATE, 12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(210, 44, CURRENT_DATE, CURRENT_DATE, 13, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(211, 157, CURRENT_DATE, CURRENT_DATE, 6, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(212, 5, CURRENT_DATE, CURRENT_DATE, 18, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(213, 34, CURRENT_DATE, CURRENT_DATE, 21, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(214, 99, CURRENT_DATE, CURRENT_DATE, 6, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(215, 14, CURRENT_DATE, CURRENT_DATE, 20, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(216, 144, CURRENT_DATE, CURRENT_DATE, 24, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(217, 95, CURRENT_DATE, CURRENT_DATE, 25, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(218, 139, CURRENT_DATE, CURRENT_DATE, 27, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(219, 43, CURRENT_DATE, CURRENT_DATE, 29, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(220, 101, CURRENT_DATE, CURRENT_DATE, 3, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(221, 136, CURRENT_DATE, CURRENT_DATE, 10, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(222, 55, CURRENT_DATE, CURRENT_DATE, 4, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(223, 82, CURRENT_DATE, CURRENT_DATE, 27, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(224, 24, CURRENT_DATE, CURRENT_DATE, 23, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(225, 87, CURRENT_DATE, CURRENT_DATE, 21, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(226, 80, CURRENT_DATE, CURRENT_DATE, 16, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(227, 15, CURRENT_DATE, CURRENT_DATE, 30, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(228, 7, CURRENT_DATE, CURRENT_DATE, 26, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(229, 58, CURRENT_DATE, CURRENT_DATE, 23, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(230, 130, CURRENT_DATE, CURRENT_DATE, 7, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(231, 65, CURRENT_DATE, CURRENT_DATE, 19, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(232, 28, CURRENT_DATE, CURRENT_DATE, 17, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(233, 28, CURRENT_DATE, CURRENT_DATE, 5, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(234, 47, CURRENT_DATE, CURRENT_DATE, 17, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(235, 128, CURRENT_DATE, CURRENT_DATE, 19, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(236, 45, CURRENT_DATE, CURRENT_DATE, 11, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(237, 90, CURRENT_DATE, CURRENT_DATE, 30, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(238, 67, CURRENT_DATE, CURRENT_DATE, 12, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(239, 88, CURRENT_DATE, CURRENT_DATE, 21, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL),
(240, 140, CURRENT_DATE, CURRENT_DATE, 4, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP, NULL);
{% endmacro %}
